<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>VICK DATAFLOW - Final</title>

<!-- â–¬â–¬â–¬ DEPENDENCIAS CORRECTAS â–¬â–¬â–¬ -->

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Leaflet -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css">
<script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- html2canvas + jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- â–¬â–¬â–¬ ESTILOS â–¬â–¬â–¬ -->
<style>
:root{--vick-blue:#004c97;--vick-light:#1a73e8;--vick-green:#009e60;--bg:#f3f8fc;--card:#fff;--text:#12202b;--muted:#667085}
:root.dark{--vick-blue:#05223a;--vick-light:#0b2b4a;--vick-green:#13b76a;--bg:#0f1720;--card:#0b1220;--text:#e6eef6;--muted:#9fb0c6}
body{margin:0;background:var(--bg);font-family:Arial;color:var(--text);}

/* SIDEBAR */
.sidebar{
    width:260px;background:var(--vick-blue);color:#fff;
    height:100vh;position:fixed;top:0;left:0;padding:20px;
}
.sidebar h2{text-align:center;margin-top:0}
.sidebar a{
    color:white;text-decoration:none;display:block;
    padding:10px;margin-bottom:6px;border-radius:6px;
}
.sidebar a:hover{background:var(--vick-light)}

.content{margin-left:280px;padding:25px}

/* Tarjetas */
.card{
    background:var(--card);padding:20px;border-radius:12px;
    margin-bottom:20px;box-shadow:0 4px 20px rgba(0,0,0,.1);
}

.chart-container{height:300px}

/* Avatar */
#avatar-btn{
    position:fixed;bottom:30px;right:30px;width:70px;height:70px;
    background:var(--vick-green);border-radius:50%;cursor:pointer;
    display:flex;align-items:center;justify-content:center;
}
#avatar-btn img{width:60px;height:60px;border-radius:50%}

/* Chat Bot */
#chat-panel{
    position:fixed;bottom:120px;right:30px;width:330px;height:480px;
    background:var(--card);border-radius:12px;display:none;
    box-shadow:0 10px 40px rgba(0,0,0,.2);flex-direction:column;
}
.chat-header{
    background:var(--vick-blue);padding:12px;color:white;
    border-radius:12px 12px 0 0;font-weight:bold;
}
.chat-body{flex:1;padding:12px;overflow-y:auto}
.msg-bot{background:#e6f8e8;padding:8px;margin-bottom:10px;border-radius:8px}
.msg-user{background:#dbe8ff;padding:8px;margin-bottom:10px;border-radius:8px;text-align:right}

.chat-input{padding:10px;display:flex;gap:8px}
.chat-input input{flex:1;padding:8px;border:1px solid #ccc;border-radius:8px}
.chat-input button{padding:8px 12px;background:var(--vick-green);border:none;color:white;border-radius:8px;font-weight:bold}
</style>
</head>

<body>

<!-- â–¬â–¬â–¬ SIDEBAR â–¬â–¬â–¬ -->
<div class="sidebar">
  <h2>VICK DATAFLOW</h2>
  <a href="#dashboard">Dashboard</a>
  <a href="#inventarios">Inventarios</a>
  <a href="#tendencias">Tendencias</a>
  <a href="#mapa">Mapa Interactivo</a>
  <a href="#historico">HistÃ³rico Mensual</a>
</div>

<!-- â–¬â–¬â–¬ CONTENIDO â–¬â–¬â–¬ -->
<div class="content">

    <h1>VICK DATAFLOW - Procter & Gamble</h1>
    <p>AnÃ¡lisis de demanda e inventarios | Vick Vaporub</p>

    <button id="exportPdfBtn">â¬‡ Exportar PDF</button>
    <button id="darkModeBtn">ðŸŒ™ Modo oscuro</button>

    <!-- Dashboard -->
    <div id="dashboard" class="card">
        <h3>Demanda y ProyecciÃ³n IA</h3>
        <div class="chart-container"><canvas id="demandaChart"></canvas></div>
        <br>
        <h4>ProyecciÃ³n IA (6 dÃ­as)</h4>
        <div class="chart-container"><canvas id="prediccionChart"></canvas></div>
    </div>

    <!-- Inventarios -->
    <div id="inventarios" class="card">
        <h3>Inventarios por ciudad</h3>
        <div class="chart-container"><canvas id="inventarioChart"></canvas></div>
    </div>

    <!-- Tendencias -->
    <div id="tendencias" class="card">
        <h3>Tendencias</h3>
        <div class="chart-container"><canvas id="tendenciasChart"></canvas></div>
    </div>

    <!-- Mapa -->
    <div id="mapa" class="card">
        <h3>Mapa Interactivo de Inventarios</h3>
        <div id="map" style="height:380px;"></div>
    </div>

    <!-- HistÃ³rico -->
    <div id="historico" class="card">
        <h3>HistÃ³rico mensual</h3>
        <select id="monthSelect">
            <option value="0">Enero</option>
            <option value="1">Febrero</option>
            <option value="2">Marzo</option>
            <option value="3" selected>Abril</option>
        </select>
        <div class="chart-container"><canvas id="historicoChart"></canvas></div>
    </div>

</div>

<!-- â–¬â–¬â–¬ BOTON AVATAR â–¬â–¬â–¬ -->
<div id="avatar-btn">
    <img src="Vicky.png" alt="MamÃ¡ Vicky">
</div>

<!-- â–¬â–¬â–¬ CHAT PANEL â–¬â–¬â–¬ -->
<div id="chat-panel">
    <div class="chat-header">MamÃ¡ Vicky - Asistente Vick</div>
    <div id="chat-body" class="chat-body">
        <div class="msg-bot">Hola, soy MamÃ¡ Vicky. Â¿En quÃ© puedo ayudarte?</div>
    </div>
    <div class="chat-input">
        <input id="chatInput" placeholder="Escribe tu pregunta...">
        <button onclick="sendChat()">Enviar</button>
    </div>
</div>

<!-- â–¬â–¬â–¬ JAVASCRIPT â–¬â–¬â–¬ -->
<script>

// Mostrar/Ocultar chat
document.getElementById("avatar-btn").onclick = () => {
    let panel = document.getElementById("chat-panel");
    panel.style.display = panel.style.display === "flex" ? "none" : "flex";
};

// Enviar mensaje del chat
function sendChat(){
    let input = document.getElementById("chatInput");
    if(input.value.trim()==="") return;

    let box = document.getElementById("chat-body");

    // Mensaje usuario
    box.innerHTML += `<div class="msg-user">${input.value}</div>`;

    // Respuesta bot
let userText = input.value.toLowerCase();

// LÃ³gica simple de respuestas
let respuesta = "Estoy procesando tu consulta ðŸ˜Š";

if (userText.includes("inventario")) {
    respuesta = "AquÃ­ tienes el inventario actualizado ðŸ“¦";
}

if (userText.includes("bogota")) {
    respuesta = "Inventario para BogotÃ¡: 120 unidades disponibles.";
}

if (userText.includes("tendencias")) {
    respuesta = "Estas son las tendencias mÃ¡s importantes ðŸ“Š";
}

box.innerHTML += `<div class="msg-bot">${respuesta}</div>`;
    box.scrollTop = box.scrollHeight;
}

/* â–¬â–¬â–¬ GRÃFICAS â–¬â–¬â–¬ */

const simpleLabels = ["Lun","Mar","MiÃ©","Jue","Vie","SÃ¡b","Dom"];

new Chart(document.getElementById("demandaChart"), {
  type: "line",
  data: {
    labels: simpleLabels,
    datasets:[{
      label:"Demanda Real",
      data:[20,25,30,28,32,40,38],
      borderColor:"#1a73e8"
    }]
  }
});

new Chart(document.getElementById("prediccionChart"), {
  type:"bar",
  data:{
    labels:["DÃ­a 1","DÃ­a 2","DÃ­a 3","DÃ­a 4","DÃ­a 5","DÃ­a 6"],
    datasets:[{
      label:"PredicciÃ³n IA",
      data:[30,35,40,42,45,47],
      backgroundColor:"#009e60"
    }]
  }
});

new Chart(document.getElementById("inventarioChart"), {
  type:"bar",
  data:{
    labels:["BogotÃ¡","MedellÃ­n","Cali"],
    datasets:[{
      label:"Inventario %",
      data:[80,55,70],
      backgroundColor:["#004c97","#1a73e8","#009e60"]
    }]
  }
});

new Chart(document.getElementById("tendenciasChart"), {
  type:"line",
  data:{
    labels:simpleLabels,
    datasets:[{
      label:"Tendencia",
      data:[10,20,40,30,50,45,60],
      borderColor:"#004c97"
    }]
  }
});

new Chart(document.getElementById("historicoChart"), {
  type:"bar",
  data:{
    labels:["Semana 1","Semana 2","Semana 3","Semana 4"],
    datasets:[{
      label:"Ventas",
      data:[100,140,120,160],
      backgroundColor:"#1a73e8"
    }]
  }
});

/* â–¬â–¬â–¬ MAPA â–¬â–¬â–¬ */
let map = L.map('map').setView([4.65,-74.1], 6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom:18,
}).addTo(map);

L.marker([4.65,-74.1]).addTo(map).bindPopup("BogotÃ¡");
L.marker([6.24,-75.58]).addTo(map).bindPopup("MedellÃ­n");
L.marker([3.45,-76.53]).addTo(map).bindPopup("Cali");

/* â–¬â–¬â–¬ EXPORTAR PDF â–¬â–¬â–¬ */
document.getElementById("exportPdfBtn").onclick = () => {
    html2canvas(document.body).then(canvas => {
        const img = canvas.toDataURL("image/png");
        const pdf = new jspdf.jsPDF("p","mm","a4");
        pdf.addImage(img,"PNG",0,0,210,0);
        pdf.save("VICK_DATAFLOW.pdf");
    });
};

/* â–¬â–¬â–¬ MODO OSCURO â–¬â–¬â–¬ */
document.getElementById("darkModeBtn").onclick = () => {
    document.documentElement.classList.toggle("dark");
};

</script>

    <div id="chatbot-button">
        <img src="Vicky.png" class="chatbot-icon" alt="Vicky">
   </div>
</body>
</html>
